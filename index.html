<!DOCTYPE html>
<html lang="cs">
<head>
    </head>
<body>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, get, child } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // --- CONFIG ---
        const firebaseConfig = { ... }; // DOPLŇ

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        window.search = async () => {
            const from = document.getElementById('from').value.trim();
            const to = document.getElementById('to').value.trim();
            const div = document.getElementById('results');
            div.innerHTML = "Hledám v databázi...";

            try {
                // ZMĚNA: Čteme z databáze 'spoje'
                const snapshot = await get(ref(db, 'spoje'));
                
                if (!snapshot.exists()) {
                    div.innerHTML = "Žádná data v jízdním řádu.";
                    return;
                }

                const trains = Object.values(snapshot.val()); // Převedeme na pole
                div.innerHTML = "";
                let foundAny = false;

                for (const t of trains) {
                    // ... ZBYTEK LOGIKY JE STEJNÝ (Hledání indexA, indexB, výpočet zpoždění...) ...
                    // Jen nezapomeň, že teď 't' je objekt z databáze
                    
                    const idxA = t.trasa.findIndex(s => s.stanice === from);
                    const idxB = t.trasa.findIndex(s => s.stanice === to);
                    
                    if (idxA !== -1 && idxB !== -1 && idxA < idxB) {
                         // Zde vlož logiku pro výpis (zkopíruj z minulého index.html)
                         // Nezapomeň kontrolovat 'odjezdy' a 'zpozdeni' z DB
                         
                         foundAny = true;
                         div.innerHTML += `<div class="result"><h3>${t.nazev}</h3>...</div>`;
                    }
                }
                
                if(!foundAny) div.innerHTML = "Nic nenalezeno.";

            } catch (e) {
                console.error(e);
                div.innerHTML = "Chyba systému.";
            }
        };
    </script>
</body>
</html>
